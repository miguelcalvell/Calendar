<!doctype html>
<html lang="es" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- ✅ Ayuda a que TODOS los paths relativos apunten a /Calendar/ -->
    <base href="/Calendar/">
    <!-- Manifest referenciado de forma relativa -->
    <link rel="manifest" href="manifest.webmanifest" />
    <meta name="theme-color" content="#111827" />
    <title>Gallinero</title>
  </head>
  <body class="bg-black text-white">
    <div id="root"><noscript>Necesitas habilitar JavaScript.</noscript></div>

    <!-- ✅ Bootstrap HashRouter y diagnóstico + fallback de carga -->
    <script>
      (function () {
        // 1) Si entras sin hash, fuerza "#/"
        if (!location.hash) {
          var href = location.href;
          if (!href.endsWith('/')) href += '/';
          location.replace(href + '#/');
        }

        // 2) Si Vite no inyectó (por cualquier motivo) el <script type="module"> final,
        //    intenta cargar el primer "modulepreload" como entry.
        window.addEventListener('DOMContentLoaded', function () {
          var hasModuleScript = !!document.querySelector('script[type="module"][src*="assets/"]')
          if (!hasModuleScript) {
            var mp = document.querySelector('link[rel="modulepreload"][href*="assets/"]')
            if (mp) {
              var s = document.createElement('script')
              s.type = 'module'
              s.src = mp.getAttribute('href')
              document.head.appendChild(s)
            }
          }
        })

        // 3) Si en 3s React no montó nada, muestra aviso visible (en lugar de “todo negro”)
        window.addEventListener('load', function () {
          setTimeout(function () {
            var root = document.getElementById('root');
            if (root && root.childElementCount === 0) {
              root.innerHTML =
                '<div style="max-width:720px;margin:32px auto;padding:16px;background:#1f2937;border-radius:8px;font-family:system-ui;color:#e5e7eb">' +
                '<h1 style="margin:0 0 8px">No se cargó el bundle</h1>' +
                '<p style="margin:0 0 8px">Borra la caché del sitio <em>github.io</em> y recarga.</p>' +
                '<p style="margin:0">URL sugerida: <code>https://miguelcalvell.github.io/Calendar/#/</code></p>' +
                '</div>';
            }
          }, 3000);
        });
      })();
    </script>

    <!-- ✅ En dev esto apunta a /src/main.tsx; en build Vite lo transforma a assets/... relativos -->
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>